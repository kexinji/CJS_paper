plot(data[which(data[,1] == s[14]), 9], log(data[which(data[,1] == s[14]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[15]), 9], log(data[which(data[,1] == s[15]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[16]), 9], log(data[which(data[,1] == s[16]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[17]), 9], log(data[which(data[,1] == s[17]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[18]), 9], log(data[which(data[,1] == s[18]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[19]), 9], log(data[which(data[,1] == s[19]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[20]), 9], log(data[which(data[,1] == s[20]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(f1, 3), type = "l", lwd=2, col = "red", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(lowerF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(upperF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
id <- dataComp[,1]
m <- 20
set.seed(42)
s <- sample(1:max(id), m)
data <- lapply(1:m, function(v) return(rbind(dataComp[which(id == s[v]),])))
data <- do.call(rbind, data) # 906*6
data$day <- data$standday + 28*(data$CYCLE-1)
plot(data[which(data[,1] == s[1]), 9], log(data[which(data[,1] == s[1]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[2]), 9], log(data[which(data[,1] == s[2]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[3]), 9], log(data[which(data[,1] == s[3]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[4]), 9], log(data[which(data[,1] == s[4]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[5]), 9], log(data[which(data[,1] == s[5]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[6]), 9], log(data[which(data[,1] == s[6]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[7]), 9], log(data[which(data[,1] == s[7]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[8]), 9], log(data[which(data[,1] == s[8]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[9]), 9], log(data[which(data[,1] == s[9]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[10]), 9], log(data[which(data[,1] == s[10]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[11]), 9], log(data[which(data[,1] == s[11]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[12]), 9], log(data[which(data[,1] == s[12]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[13]), 9], log(data[which(data[,1] == s[13]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[14]), 9], log(data[which(data[,1] == s[14]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[15]), 9], log(data[which(data[,1] == s[15]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[16]), 9], log(data[which(data[,1] == s[16]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[17]), 9], log(data[which(data[,1] == s[17]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[18]), 9], log(data[which(data[,1] == s[18]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[19]), 9], log(data[which(data[,1] == s[19]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[20]), 9], log(data[which(data[,1] == s[20]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(f1, 3), type = "l", lwd=2, col = "red", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(lowerF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(upperF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
s
head(data)
data[which(data[,1] == s[20]), 9]
data[which(data[,1] == s[20]), 8]
plot(data[which(data[,1] == s[1]), 8], log(data[which(data[,1] == s[1]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[2]), 8], log(data[which(data[,1] == s[2]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[3]), 8], log(data[which(data[,1] == s[3]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[4]), 8], log(data[which(data[,1] == s[4]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[5]), 8], log(data[which(data[,1] == s[5]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[6]), 8], log(data[which(data[,1] == s[6]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[7]), 8], log(data[which(data[,1] == s[7]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[8]), 8], log(data[which(data[,1] == s[8]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[9]), 8], log(data[which(data[,1] == s[9]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[10]), 8], log(data[which(data[,1] == s[10]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[11]), 8], log(data[which(data[,1] == s[11]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[12]), 8], log(data[which(data[,1] == s[12]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[13]), 8], log(data[which(data[,1] == s[13]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[14]), 8], log(data[which(data[,1] == s[14]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[15]), 8], log(data[which(data[,1] == s[15]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[16]), 8], log(data[which(data[,1] == s[16]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[17]), 8], log(data[which(data[,1] == s[17]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[18]), 8], log(data[which(data[,1] == s[18]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[19]), 8], log(data[which(data[,1] == s[19]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[20]), 8], log(data[which(data[,1] == s[20]), 4]), xlim = c(1,84), ylim = c(-3.5,3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(f1, 3), type = "l", lwd=2, col = "red", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(lowerF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(upperF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
range(log(data[,5]))
range(log(data[,4]))
plot(data[which(data[,1] == s[1]), 8], log(data[which(data[,1] == s[1]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[2]), 8], log(data[which(data[,1] == s[2]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[3]), 8], log(data[which(data[,1] == s[3]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[4]), 8], log(data[which(data[,1] == s[4]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[5]), 8], log(data[which(data[,1] == s[5]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[6]), 8], log(data[which(data[,1] == s[6]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[7]), 8], log(data[which(data[,1] == s[7]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[8]), 8], log(data[which(data[,1] == s[8]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[9]), 8], log(data[which(data[,1] == s[9]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[10]), 8], log(data[which(data[,1] == s[10]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[11]), 8], log(data[which(data[,1] == s[11]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[12]), 8], log(data[which(data[,1] == s[12]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[13]), 8], log(data[which(data[,1] == s[13]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[14]), 8], log(data[which(data[,1] == s[14]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[15]), 8], log(data[which(data[,1] == s[15]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[16]), 8], log(data[which(data[,1] == s[16]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[17]), 8], log(data[which(data[,1] == s[17]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[18]), 8], log(data[which(data[,1] == s[18]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[19]), 8], log(data[which(data[,1] == s[19]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[20]), 8], log(data[which(data[,1] == s[20]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(f1, 3), type = "l", lwd=2, col = "red", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(lowerF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(upperF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
plot(data[which(data[,1] == s[1]), 8], log(data[which(data[,1] == s[1]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen")
par(new = T)
plot(data[which(data[,1] == s[2]), 8], log(data[which(data[,1] == s[2]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[3]), 8], log(data[which(data[,1] == s[3]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[4]), 8], log(data[which(data[,1] == s[4]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[5]), 8], log(data[which(data[,1] == s[5]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[6]), 8], log(data[which(data[,1] == s[6]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[7]), 8], log(data[which(data[,1] == s[7]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[8]), 8], log(data[which(data[,1] == s[8]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[9]), 8], log(data[which(data[,1] == s[9]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[10]), 8], log(data[which(data[,1] == s[10]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[11]), 8], log(data[which(data[,1] == s[11]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen")
par(new = T)
plot(data[which(data[,1] == s[12]), 8], log(data[which(data[,1] == s[12]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[13]), 8], log(data[which(data[,1] == s[13]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[14]), 8], log(data[which(data[,1] == s[14]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[15]), 8], log(data[which(data[,1] == s[15]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[16]), 8], log(data[which(data[,1] == s[16]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[17]), 8], log(data[which(data[,1] == s[17]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[18]), 8], log(data[which(data[,1] == s[18]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[19]), 8], log(data[which(data[,1] == s[19]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[20]), 8], log(data[which(data[,1] == s[20]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(rep(f2, 3), type = "l", lwd=2, col = "red", xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(rep(lowerF2, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(rep(upperF2, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(mfrow=c(2,1))
plot(data[which(data[,1] == s[1]), 8], log(data[which(data[,1] == s[1]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[2]), 8], log(data[which(data[,1] == s[2]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[3]), 8], log(data[which(data[,1] == s[3]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[4]), 8], log(data[which(data[,1] == s[4]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[5]), 8], log(data[which(data[,1] == s[5]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[6]), 8], log(data[which(data[,1] == s[6]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[7]), 8], log(data[which(data[,1] == s[7]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[8]), 8], log(data[which(data[,1] == s[8]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[9]), 8], log(data[which(data[,1] == s[9]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[10]), 8], log(data[which(data[,1] == s[10]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[11]), 8], log(data[which(data[,1] == s[11]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[12]), 8], log(data[which(data[,1] == s[12]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[13]), 8], log(data[which(data[,1] == s[13]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[14]), 8], log(data[which(data[,1] == s[14]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[15]), 8], log(data[which(data[,1] == s[15]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[16]), 8], log(data[which(data[,1] == s[16]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[17]), 8], log(data[which(data[,1] == s[17]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[18]), 8], log(data[which(data[,1] == s[18]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[19]), 8], log(data[which(data[,1] == s[19]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[20]), 8], log(data[which(data[,1] == s[20]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(f1, 3), type = "l", lwd=2, col = "red", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(lowerF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(upperF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
#------------------------------------------------------------------------------
# estrogen
plot(data[which(data[,1] == s[1]), 8], log(data[which(data[,1] == s[1]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen")
par(new = T)
plot(data[which(data[,1] == s[2]), 8], log(data[which(data[,1] == s[2]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[3]), 8], log(data[which(data[,1] == s[3]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[4]), 8], log(data[which(data[,1] == s[4]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[5]), 8], log(data[which(data[,1] == s[5]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[6]), 8], log(data[which(data[,1] == s[6]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[7]), 8], log(data[which(data[,1] == s[7]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[8]), 8], log(data[which(data[,1] == s[8]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[9]), 8], log(data[which(data[,1] == s[9]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[10]), 8], log(data[which(data[,1] == s[10]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[11]), 8], log(data[which(data[,1] == s[11]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen")
par(new = T)
plot(data[which(data[,1] == s[12]), 8], log(data[which(data[,1] == s[12]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[13]), 8], log(data[which(data[,1] == s[13]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[14]), 8], log(data[which(data[,1] == s[14]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[15]), 8], log(data[which(data[,1] == s[15]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[16]), 8], log(data[which(data[,1] == s[16]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[17]), 8], log(data[which(data[,1] == s[17]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[18]), 8], log(data[which(data[,1] == s[18]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[19]), 8], log(data[which(data[,1] == s[19]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[20]), 8], log(data[which(data[,1] == s[20]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(rep(f2, 3), type = "l", lwd=2, col = "red", xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(rep(lowerF2, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(rep(upperF2, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
pdf( "test.pdf", width = 16, height = 8 )
plot(data[which(data[,1] == s[1]), 8], log(data[which(data[,1] == s[1]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[2]), 8], log(data[which(data[,1] == s[2]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[3]), 8], log(data[which(data[,1] == s[3]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[4]), 8], log(data[which(data[,1] == s[4]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[5]), 8], log(data[which(data[,1] == s[5]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[6]), 8], log(data[which(data[,1] == s[6]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[7]), 8], log(data[which(data[,1] == s[7]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[8]), 8], log(data[which(data[,1] == s[8]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[9]), 8], log(data[which(data[,1] == s[9]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[10]), 8], log(data[which(data[,1] == s[10]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[11]), 8], log(data[which(data[,1] == s[11]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[12]), 8], log(data[which(data[,1] == s[12]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[13]), 8], log(data[which(data[,1] == s[13]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[14]), 8], log(data[which(data[,1] == s[14]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[15]), 8], log(data[which(data[,1] == s[15]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[16]), 8], log(data[which(data[,1] == s[16]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[17]), 8], log(data[which(data[,1] == s[17]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[18]), 8], log(data[which(data[,1] == s[18]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[19]), 8], log(data[which(data[,1] == s[19]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[20]), 8], log(data[which(data[,1] == s[20]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(f1, 3), type = "l", lwd=2, col = "red", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(lowerF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(upperF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
dev.new(width=8, height=4)
plot(data[which(data[,1] == s[1]), 8], log(data[which(data[,1] == s[1]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[2]), 8], log(data[which(data[,1] == s[2]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[3]), 8], log(data[which(data[,1] == s[3]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[4]), 8], log(data[which(data[,1] == s[4]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[5]), 8], log(data[which(data[,1] == s[5]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[6]), 8], log(data[which(data[,1] == s[6]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[7]), 8], log(data[which(data[,1] == s[7]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[8]), 8], log(data[which(data[,1] == s[8]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[9]), 8], log(data[which(data[,1] == s[9]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[10]), 8], log(data[which(data[,1] == s[10]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[11]), 8], log(data[which(data[,1] == s[11]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone")
par(new = T)
plot(data[which(data[,1] == s[12]), 8], log(data[which(data[,1] == s[12]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[13]), 8], log(data[which(data[,1] == s[13]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[14]), 8], log(data[which(data[,1] == s[14]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[15]), 8], log(data[which(data[,1] == s[15]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[16]), 8], log(data[which(data[,1] == s[16]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[17]), 8], log(data[which(data[,1] == s[17]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[18]), 8], log(data[which(data[,1] == s[18]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[19]), 8], log(data[which(data[,1] == s[19]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[20]), 8], log(data[which(data[,1] == s[20]), 4]), xlim = c(1,84), ylim = c(-3, 4), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(f1, 3), type = "l", lwd=2, col = "red", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(lowerF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
par(new = T)
plot(rep(upperF1, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(-3.5, 3.5), xlab = "Days in standardized menstrual cycle", ylab = "Log progesterone", yaxt="n", xaxt="n")
dev.new(width=8, height=4)
plot(data[which(data[,1] == s[1]), 8], log(data[which(data[,1] == s[1]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen")
par(new = T)
plot(data[which(data[,1] == s[2]), 8], log(data[which(data[,1] == s[2]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[3]), 8], log(data[which(data[,1] == s[3]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[4]), 8], log(data[which(data[,1] == s[4]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[5]), 8], log(data[which(data[,1] == s[5]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[6]), 8], log(data[which(data[,1] == s[6]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[7]), 8], log(data[which(data[,1] == s[7]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[8]), 8], log(data[which(data[,1] == s[8]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[9]), 8], log(data[which(data[,1] == s[9]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[10]), 8], log(data[which(data[,1] == s[10]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[11]), 8], log(data[which(data[,1] == s[11]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen")
par(new = T)
plot(data[which(data[,1] == s[12]), 8], log(data[which(data[,1] == s[12]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[13]), 8], log(data[which(data[,1] == s[13]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[14]), 8], log(data[which(data[,1] == s[14]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[15]), 8], log(data[which(data[,1] == s[15]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[16]), 8], log(data[which(data[,1] == s[16]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[17]), 8], log(data[which(data[,1] == s[17]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[18]), 8], log(data[which(data[,1] == s[18]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[19]), 8], log(data[which(data[,1] == s[19]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(data[which(data[,1] == s[20]), 8], log(data[which(data[,1] == s[20]), 5]), xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(rep(f2, 3), type = "l", lwd=2, col = "red", xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(rep(lowerF2, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
par(new = T)
plot(rep(upperF2, 3), type = "l", col = "green", xlim = c(1,84), ylim = c(1, 6), xlab = "Days in standardized menstrual cycle", ylab = "Log estrogen", yaxt="n", xaxt="n")
source("bivFns_3c.R")
# Plots for data with 3 concecutive cycles
dataComp <- read.table("data_3cycle.txt", header = T)
#------------------------------------------------------------------------------
# randomly select m subjects with 3 concecutive cycles
id <- dataComp[,1]
m <- 20
set.seed(42)
s <- sample(1:max(id), m)
data <- lapply(1:m, function(v) return(rbind(dataComp[which(id == s[v]),])))
data <- do.call(rbind, data) # 906*6
data$day <- data$standday + 28*(data$CYCLE-1)
#------------------------------------------------------------------------------
# f hat
# liuResult <- read.table("Liu3c_test_v2.txt", sep = ",", header = T)
liuResult <- read.table("Liu3c_20subj.txt", sep = ",", header = T)
head(liuResult)
round(3.11111111, 3)
round(liuResult, 4)
round(liuResult[,2], 4)
liuResult[(15+6+56+1:15+6+56+6),]
liuResult[(15+6+56+1):(15+6+56+6),]
round(liuResult[(15+6+56+1):(15+6+56+6),],4)
round(liuResult[(15+6+56+1):(15+6+56+6),2],4)
#------------------------------------------------------------------------------
# create two indicator variables
# dataComp <- read.table("data_3concecutive.txt", header = T)
dataComp <- read.table("data_3cycle.txt", header = T)
dataComp$underWeight <- 0
dataComp$underWeight[which(dataComp$BMI == 1)] <- 1
dataComp$overWeight <- 0
dataComp$overWeight[which(dataComp$BMI == 3)] <- 1
dataComp$BMI <- NULL
#------------------------------------------------------------------------------
# m = 10, randomly select 10 subjects with 4 concecutive cycles, but only use 3 cycles
id <- dataComp[,1]
m <- 30
id
max(id)
?quantile
#------------------------------------------------------------------------------
# create two indicator variables
# dataComp <- read.table("data_3concecutive.txt", header = T)
dataComp <- read.table("data_3cycle.txt", header = T)
dataComp$underWeight <- 0
dataComp$underWeight[which(dataComp$BMI == 1)] <- 1
dataComp$overWeight <- 0
dataComp$overWeight[which(dataComp$BMI == 3)] <- 1
dataComp$BMI <- NULL
#------------------------------------------------------------------------------
# m = 10, randomly select 10 subjects with 4 concecutive cycles, but only use 3 cycles
id <- dataComp[,1]
m <- 40
# seed 42 doesn't work for 30 subjects
# Now change it to 60
set.seed(60)
samp <- sample(1:max(id), m)
data <- lapply(1:m, function(v) return(rbind(dataComp[which(id == samp[v]),])))
data <- do.call(rbind, data)
dim(data)
head(data)
3286*2
# Centre the covariate - age
niVec <- sapply(1:m, function(v) return(nrow(data[which(dataComp[,1] == samp[v]),])))
age_index <- sapply(1:(m-1), function(v) return(1+sum(niVec[1:v])))
medianAge <- median(data[c(1, age_index), 6])
data$age <- (data$age - medianAge)/100
medianAge
install.packages('RcppEigen')
